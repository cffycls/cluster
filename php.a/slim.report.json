{
  "type": "build",
  "state": "done",
  "image_reference": "cffycls/php",
  "system": {
    "type": "Linux",
    "release": "4.15.0-30deepin-generic",
    "os": "Alpine Linux 3.11.2"
  },
  "source_image": {
    "id": "sha256:2e427d0b71674a04f87841fcf63d476e4ef585f8256fbaaa566abfae4cc2d63c",
    "name": "cffycls/php:latest",
    "size": 464769942,
    "size_human": "465 MB",
    "create_time": "2020-04-02T06:46:00Z",
    "all_names": [
      "cffycls/php:latest",
      "cffycls/php:slim"
    ],
    "Author": "cffycls@foxmail.com",
    "docker_version": "19.03.8",
    "architecture": "amd64",
    "exposed_ports": [
      "9000/tcp"
    ]
  },
  "minified_image_size": 59107235,
  "minified_image_size_human": "59 MB",
  "minified_image": "cffycls/php.slim",
  "minified_image_has_data": true,
  "minified_by": 7.8631650084799265,
  "artifact_location": "/tmp/docker-slim-state/.docker-slim-state/images/2e427d0b71674a04f87841fcf63d476e4ef585f8256fbaaa566abfae4cc2d63c/artifacts",
  "container_report_name": "creport.json",
  "seccomp_profile_name": "cffycls-php-seccomp.json",
  "apparmor_profile_name": "cffycls-php-apparmor-profile",
  "image_stack": [
    {
      "is_top_image": false,
      "id": "sha256:cc0abc535e36a7ede71978ba2bbd8159b8a5420b91f2fbc520cdf5f673640a34",
      "full_name": "alpine:3.11",
      "repo_name": "alpine",
      "version_tag": "3.11",
      "raw_tags": [
        "alpine:3.11"
      ],
      "create_time": "2019-12-24T19:20:12Z",
      "new_size": 5591300,
      "new_size_human": "5.6 MB",
      "instructions": [
        {
          "type": "ADD",
          "time": "2019-12-24T19:20:12Z",
          "is_nop": true,
          "local_image_exits": false,
          "layer_index": 0,
          "size": 5591300,
          "size_human": "5.6 MB",
          "params": "file:36fdc8cb08228a87093fb227736f4ce1d4d6c15366326dea541fbbd863976ee5 in /",
          "command_snippet": "ADD file:36fdc8cb08228a87093fb227736f4ce1d4d..."
        },
        {
          "type": "CMD",
          "time": "2019-12-24T19:20:12Z",
          "is_last_instruction": true,
          "is_nop": true,
          "is_exec_form": true,
          "local_image_exits": true,
          "layer_index": 0,
          "size": 0,
          "params": "[\"/bin/sh\"]",
          "command_snippet": "CMD [\"/bin/sh\"]",
          "raw_tags": [
            "alpine:3.11"
          ]
        }
      ]
    },
    {
      "is_top_image": true,
      "id": "sha256:2e427d0b71674a04f87841fcf63d476e4ef585f8256fbaaa566abfae4cc2d63c",
      "full_name": "cffycls/php:latest",
      "repo_name": "cffycls/php",
      "version_tag": "latest",
      "raw_tags": [
        "cffycls/php:latest",
        "cffycls/php:slim"
      ],
      "create_time": "2020-04-02T06:46:00Z",
      "new_size": 459178642,
      "new_size_human": "459 MB",
      "base_image_id": "sha256:cc0abc535e36a7ede71978ba2bbd8159b8a5420b91f2fbc520cdf5f673640a34",
      "instructions": [
        {
          "type": "MAINTAINER",
          "time": "2020-01-06T01:13:39Z",
          "is_nop": true,
          "local_image_exits": true,
          "intermediate_image_id": "sha256:70b4aab2255cd294e37fae514412788d7845c1f08f4f2c2b91eaa26011c7176e",
          "layer_index": 0,
          "size": 0,
          "params": "cffycls@foxmail.com",
          "command_snippet": "MAINTAINER cffycls@foxmail.com"
        },
        {
          "type": "ENV",
          "time": "2020-04-01T14:12:21Z",
          "is_nop": true,
          "local_image_exits": true,
          "intermediate_image_id": "sha256:a897b730f60dfe618d325ff34e812d580c1e35eca6b9c03551d4b1e95a4cd27a",
          "layer_index": 0,
          "size": 0,
          "params": "PHP_VERSION=7.4.4",
          "command_snippet": "ENV PHP_VERSION=7.4.4"
        },
        {
          "type": "COPY",
          "time": "2020-04-01T14:12:22Z",
          "is_nop": true,
          "local_image_exits": true,
          "intermediate_image_id": "sha256:ee4dc485ab08d7e18d4f19f6c4c93244a896a74a1cd41dfd54af0f20d52d5c2f",
          "layer_index": 0,
          "size": 34916844,
          "size_human": "35 MB",
          "params": "dir:276bd04446304ad6911d0cc279926545150d14133674d6c75549b205b0033500 in /tmp",
          "command_snippet": "COPY dir:276bd04446304ad6911d0cc279926545150..."
        },
        {
          "type": "RUN",
          "time": "2020-04-02T06:45:59Z",
          "is_nop": false,
          "local_image_exits": true,
          "intermediate_image_id": "sha256:915a9b923d32fbb19476fce17a51bfbfe22e4de34b22c4eee0fe91d10f55029e",
          "layer_index": 0,
          "size": 424261798,
          "size_human": "424 MB",
          "command_snippet": "RUN sed -i 's/dl-cdn.alpinelinux.org/mirrors...",
          "system_commands": [
            "sed -i 's/dl-cdn.alpinelinux.org/mirrors.aliyun.com/g' /etc/apk/repositories",
            "echo \"use local '/tmp/*' packages...\"",
            "ls -l /tmp",
            "apk update",
            "addgroup -g 82 -S www-data",
            "adduser -u 82 -D -S -G www-data www-data",
            "mkdir -p \"/usr/local/etc/php/conf.d\"",
            "mkdir -p \"/var/www/html\"",
            "chown www-data:www-data /var/www/html",
            "chmod 777 /var/www/html",
            "PHPIZE_DEPS=\"            autoconf          dpkg-dev dpkg             file             g++             gcc             libc-dev             make             pkgconf             re2c             \"",
            "PHP_DEVS=\"       argon2-dev        coreutils        curl-dev        libedit-dev        libsodium-dev        libxml2-dev        openssl-dev        sqlite-dev        libjpeg-turbo-dev             libxpm-dev            gd-dev        gettext-dev        freetype-dev        libevent-dev        rabbitmq-c-dev             pcre2-dev             oniguruma             oniguruma-dev        \"",
            "apk add --no-cache         curl         tar         xz         openssl         wget $PHPIZE_DEPS $PHP_DEVS",
            "mkdir -p ~/bulid/php",
            "cd ~/bulid/php",
            "tar -Jxf /tmp/php.tar.xz --strip-components 1",
            "./configure         --prefix=\"/usr/local/php\"         --with-config-file-path=\"/usr/local/php/etc\"         --with-config-file-scan-dir=\"/usr/local/php/etc/conf.d\"                 --enable-mbstring         --enable-mbregex         --enable-mysqlnd         --enable-sysvmsg         --enable-ftp         --enable-exif         --enable-pcntl         --enable-sockets         --enable-sysvsem         --enable-xml         --enable-bcmath         --with-openssl         --with-curl         --with-pdo-mysql         --with-libedit         --with-zlib         --with-pcre-jit         --with-pear         --with-libxml         --with-jpeg         --with-xpm         --with-freetype         --with-gettext         --with-iconv                 --enable-fpm         --with-fpm-user=www-data         --with-fpm-group=www-data         --disable-cgi",
            "make -j \"$(nproc)\"",
            "find -type f -name '*.a' -delete",
            "make install",
            "rm -rf /tmp/pear ~/.pearrc",
            "cd ../",
            "rm -rf php",
            "mkdir -p ~/build/swoole",
            "cd ~/build/swoole",
            "tar zxvf /tmp/swoole.tar.gz --strip-components 1",
            "/usr/local/php/bin/phpize",
            "./configure         --with-php-config=/usr/local/php/bin/php-config --enable-coroutine --enable-openssl  --enable-http2  --enable-async-redis --enable-sockets --enable-mysqlnd",
            "make",
            "make install",
            "cd ../",
            "rm -rf swoole",
            "mkdir -p ~/build/inotify",
            "cd ~/build/inotify",
            "tar -zxf /tmp/inotify.tgz --strip-components 1",
            "/usr/local/php/bin/phpize",
            "./configure         --with-php-config=/usr/local/php/bin/php-config         --enable-inotify",
            "make",
            "make install",
            "cd ..",
            "rm -rf inotify",
            "mkdir -p ~/build/redis",
            "cd ~/build/redis",
            "tar -zxf /tmp/redis.tgz --strip-components 1",
            "/usr/local/php/bin/phpize",
            "./configure         --with-php-config=/usr/local/php/bin/php-config         --enable-redis",
            "make",
            "make install",
            "cd ..",
            "rm -rf redis",
            "mkdir -p ~/build/libuuid",
            "cd ~/build/libuuid",
            "tar -zxf /tmp/libuuid.tgz --strip-components 1",
            "./configure --prefix=/usr",
            "make",
            "make install",
            "cd ../",
            "rm -rf libuuid",
            "mkdir -p ~/build/uuid",
            "cd ~/build/uuid",
            "tar -zxf /tmp/uuid.tgz --strip-components 1",
            "/usr/local/php/bin/phpize",
            "./configure --with-php-config=/usr/local/php/bin/php-config",
            "make",
            "make install",
            "cd ../",
            "rm -rf uuid",
            "apk add libmemcached-dev",
            "mkdir -p ~/build/memcached_p",
            "cd ~/build/memcached_p",
            "tar -zxf /tmp/memcached.tgz --strip-components 1",
            "/usr/local/php/bin/phpize",
            "./configure --with-php-config=/usr/local/php/bin/php-config",
            "make",
            "make install",
            "cd ../",
            "rm -rf memcached_p",
            "mkdir -p ~/build/event",
            "cd ~/build/event",
            "tar -zxf /tmp/event.tgz --strip-components 1",
            "/usr/local/php/bin/phpize",
            "./configure         --with-php-config=/usr/local/php/bin/php-config         --with-event-libevent-dir=/usr",
            "make",
            "make install",
            "cd ../",
            "rm -rf event",
            "mkdir -p ~/build/imagemagick",
            "cd ~/build/imagemagick",
            "tar -zxf /tmp/imagemagick.tgz --strip-components 1",
            "./configure",
            "make",
            "make install",
            "cd ../",
            "rm -rf imagemagick",
            "mkdir -p ~/build/imagick",
            "cd ~/build/imagick",
            "tar -zxf /tmp/imagick.tgz --strip-components 1",
            "/usr/local/php/bin/phpize",
            "./configure --with-php-config=/usr/local/php/bin/php-config",
            "make",
            "make install",
            "cd ../",
            "rm -rf imagick",
            "ln -s /usr/local/php/bin/* /usr/local/bin/",
            "ln -s /usr/local/php/sbin/php-fpm /usr/local/bin",
            "pecl channel-update pecl.php.net",
            "pecl install igbinary",
            "pecl install amqp",
            "pecl install apcu",
            "pecl install protobuf",
            "rm -rf /tmp/* ~/.pearrc ~/build",
            "apk del $PHPIZE_DEPS",
            "php -m"
          ]
        },
        {
          "type": "EXPOSE",
          "time": "2020-04-02T06:46:00Z",
          "is_nop": true,
          "local_image_exits": true,
          "intermediate_image_id": "sha256:a36ee750139f83e13fa9d2c6697f2a1e03ea382f3c6792b2cd18691496c0c9b6",
          "layer_index": 0,
          "size": 0,
          "params": "9000",
          "command_snippet": "EXPOSE 9000"
        },
        {
          "type": "CMD",
          "time": "2020-04-02T06:46:00Z",
          "is_last_instruction": true,
          "is_nop": true,
          "is_exec_form": true,
          "local_image_exits": true,
          "layer_index": 0,
          "size": 0,
          "params": "[\"php-fpm\"]",
          "command_snippet": "CMD [\"php-fpm\"]",
          "raw_tags": [
            "cffycls/php:latest",
            "cffycls/php:slim"
          ]
        }
      ]
    }
  ]
}
